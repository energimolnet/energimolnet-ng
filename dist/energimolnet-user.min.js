(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
var makeUrl=require("./util/makeurl"),PATH_TOKEN="oauth/token",PATH_AUTHORIZE="oauth/authorize",PATH_SIGN_IN="security/signin",PATH_SIGN_OUT="security/signout",KEY_PRIVATE_TOKEN="emPrivateToken",KEY_REFRESH_TOKEN="emRefreshToken",KEY_ACCESS_TOKEN="emAccessToken";module.exports=function(e,t,n,r,i){function o(){return s(KEY_PRIVATE_TOKEN)}function c(){return s(KEY_REFRESH_TOKEN)}function u(){return s(KEY_ACCESS_TOKEN)}function a(e){f(e,KEY_PRIVATE_TOKEN)}function _(e){f(e,KEY_REFRESH_TOKEN),l(null)}function l(e){null!==e&&(e.expires_at=Date.now()+1e3*e.expires_in),f(e,KEY_ACCESS_TOKEN)}function s(t){var n=e.localStorage.getItem(t);return!n||"{"!=n.charAt(0)&&"["!=n.charAt(0)?n:JSON.parse(n)}function f(t,n){if(t){var r=typeof t;"string"!==r&&"number"!==r&&(t=JSON.stringify(t)),e.localStorage.setItem(n,t)}else e.localStorage.removeItem(n)}function E(){return null!==o()||null!==c()}function T(e){return n(function(t,n){var i=o();if(i)return e.headers={Authorization:"OAuth "+i},void t(e);if(r.disabled)return void t(e);var u=c();return u?void d(u).then(function(n){e.headers={Authorization:"Bearer "+n.access_token},t(e)},function(){n()}):void n()})}function d(e){return n(function(t,n){var r=u();h(r)?t(r):(k.push(function(e){e?t(e):n()}),p||(p=!0,A(e).then(function(e){var t=e.data;l(t),p=!1,k.forEach(function(e){e(u())}),k=[]},function(){l(null),p=!1,k.forEach(function(e){e(null)}),k=[]})))})}function h(e){return e&&e.expires_at>Date.now()}function A(e){return t.post(makeUrl([i,PATH_TOKEN]),{client_id:r.clientId,client_secret:r.clientSecret,grant_type:"refresh_token",scope:"basic",refresh_token:e})}function K(){var e={client_secret:r.clientSecret,client_id:r.clientId,redirect_uri:r.redirectUri,grant_type:"authorization_code",response_type:"code",state:"emAuth",scope:"basic"};return makeUrl([i,PATH_AUTHORIZE],e)}function S(e){return t.post(makeUrl([i,PATH_TOKEN]),{grant_type:"authorization_code",code:e,client_id:r.clientId,client_secret:r.clientSecret,state:"emAuth",scope:"basic",redirect_uri:r.redirectUri}).then(function(e){var t=e.data;_(t.refresh_token),l(t)})}function m(e){return makeUrl([i,PATH_SIGN_IN])+"?redirect="+encodeURIComponent(e)}function N(e){return makeUrl([i,PATH_SIGN_OUT])+"?redirect="+encodeURIComponent(e)}var k=[],p=!1;return{getPrivateToken:o,setPrivateToken:a,getRefreshToken:c,setRefreshToken:_,isAuthenticated:E,loginUrl:m,logoutUrl:N,authorizeUrl:K,handleAuthCode:S,authorize:T}};


},{"./util/makeurl":27}],2:[function(require,module,exports){
function _zeroPaddedString(e){return null==e?"":(10>e?"0":"")+e}function _periodFormat(e,t,r){return null!=t&&t++,_zeroPaddedString(e)+_zeroPaddedString(t)+_zeroPaddedString(r)}function periodsFormat(e,t){return angular.isArray(e)?e.map(t).join("-"):t(e)}function getYearPeriod(e){return periodsFormat(e,function(e){return _periodFormat(e.getFullYear())})}function getMonthPeriod(e){return periodsFormat(e,function(e){return _periodFormat(e.getFullYear(),e.getMonth())})}function getDayPeriod(e){return periodsFormat(e,function(e){return _periodFormat(e.getFullYear(),e.getMonth(),e.getDate())})}function getPeriod(e,t,r){var n=angular.isArray(e),o=n&&e.length>1;if(n&&0===e.length||null===e||void 0===e)return null;if("month"===t)return o||r?getMonthPeriod(e):getYearPeriod(e);if("day"===t)return o||r?getDayPeriod(e):getMonthPeriod(e);if("week"===t&&!o){var a=n?e[0]:e,i=new Date(a.getTime());return i.setDate(i.getDate()+6),getDayPeriod([a,i])}return getDayPeriod(e)}function getDate(e){if("number"==typeof e&&(e=e.toString()),null===e||void 0===e||e.length<4)return null;for(var t=[parseInt(e.substr(0,4),10)],r=0,n=e.length;n>4+2*r;)t[r+1]=parseInt(e.substr(4+2*r,2)),r++;return new Date(t[0],t[1]?t[1]-1:0,t[2]||1,t[3]||0,t[4]||0,t[5]||0)}function daysInMonth(e){var t=new Date(e.getTime());return t.setMonth(t.getMonth()+1),t.setDate(0),t.getDate()}function parseISO(e){var t=Date.parse(e);if(!isNaN(t))return new Date(t);var r,n,o,a=e.slice(0,-5).split(/\D/).map(function(e){return parseInt(e,10)||0});return a[1]-=1,n=e.slice(-5),o=parseInt(n,10)/100,r=new Date(Date.UTC.apply(Date,a)),r.setHours(r.getHours()-o),r}module.exports={getDate:getDate,getDayPeriod:getDayPeriod,getMonthPeriod:getMonthPeriod,getPeriod:getPeriod,getYearPeriod:getYearPeriod,daysInMonth:daysInMonth,parseISO:parseISO};


},{}],3:[function(require,module,exports){
var makeUrl=require("./util/makeurl"),PATH_API_VERSION="api/2.0",EVENT_LOGIN_NEEDED="em:loginNeeded";module.exports=function(t,a,n,i,u){function d(n){return a(function(a,d){n.url=makeUrl([u,PATH_API_VERSION,n.url]),i.authorize(n).then(function(n){t(n).then(function(t){a(o(t))},function(t){401===t.status&&(i.getPrivateToken()?(i.setPrivateToken(null),e()):e()),d(t.data?t.data.errors:{})})},function(){e(),d({})})})}function e(){n.$broadcast(EVENT_LOGIN_NEEDED)}function o(t){return null==t.data.count||null==t.data.limit||null==t.data.skip?t.data.data:{data:t.data.data,pagination:{skip:t.data.skip,limit:t.data.limit,count:t.data.count,page:1+t.data.skip/t.data.limit,from:0===t.data.count?0:t.data.skip+1,to:t.data.skip+t.data.limit>t.data.count?t.data.count:t.data.skip+t.data.limit}}}return{request:d}};


},{"./util/makeurl":27}],4:[function(require,module,exports){
var MODULE_NAME="energimolnet",ngModule=angular.module(MODULE_NAME,[]);"object"==typeof module&&(module.exports=MODULE_NAME),ngModule.factory("emDateUtil",function(){return require("./date-util")}).factory("emAuth",["$window","$http","$q","authConfig","apiBaseUrl",require("./auth")]).factory("energimolnetAPI",["$http","$q","$rootScope","emAuth","apiBaseUrl",require("./energimolnet-api")]).factory("emResourceFactory",["energimolnetAPI",require("./resource-factory")]).factory("emAccounts",["emResourceFactory",require("./models/accounts")]).factory("emApps",["emResourceFactory",require("./models/apps")]).factory("emCalculatedMetrics",["emResourceFactory",require("./models/calculated-metrics")]).factory("emComplaints",["emResourceFactory",require("./models/complaints")]).factory("emConsumptionStats",["emResourceFactory",require("./models/consumption-stats")]).factory("emConsumptions",["emResourceFactory","energimolnetAPI",require("./models/consumptions")]).factory("emFeeds",["emResourceFactory",require("./models/feeds")]).factory("emFtpConnections",["emResourceFactory",require("./models/ftp-connections")]).factory("emMe",["emResourceFactory",require("./models/me")]).factory("emMeters",["emResourceFactory","energimolnetAPI",require("./models/meters")]).factory("emMeterStats",["emResourceFactory",require("./models/meter-stats")]).factory("emMetricModels",["emResourceFactory",require("./models/metric-models")]).factory("emOwners",["emResourceFactory",require("./models/owners")]).factory("emPassword",["emResourceFactory",require("./models/password")]).factory("emRefreshTokens",["emResourceFactory",require("./models/refreshtokens")]).factory("emReports",["emResourceFactory",require("./models/reports")]).factory("emRobots",["emResourceFactory","energimolnetAPI",require("./models/robots")]).factory("emRobotStats",["emResourceFactory",require("./models/robot-stats")]).factory("emScrapers",["emResourceFactory",require("./models/scrapers")]).factory("emSubaccounts",["emResourceFactory",require("./models/subaccounts")]).factory("emSubscribers",["emResourceFactory","energimolnetAPI",require("./models/subscribers")]);
},{"./auth":1,"./date-util":2,"./energimolnet-api":3,"./models/accounts":5,"./models/apps":6,"./models/calculated-metrics":7,"./models/complaints":8,"./models/consumption-stats":9,"./models/consumptions":10,"./models/feeds":11,"./models/ftp-connections":12,"./models/me":13,"./models/meter-stats":14,"./models/meters":15,"./models/metric-models":16,"./models/owners":17,"./models/password":18,"./models/refreshtokens":19,"./models/reports":20,"./models/robot-stats":21,"./models/robots":22,"./models/scrapers":23,"./models/subaccounts":24,"./models/subscribers":25,"./resource-factory":26}],5:[function(require,module,exports){
module.exports=function(e){return e({"default":"/accounts",get:!0,query:!0,put:!0,post:!0,"delete":!0})};


},{}],6:[function(require,module,exports){
module.exports=function(e){return e({forAccount:{"default":"apps",get:!0,query:!0,"delete":!0}})};


},{}],7:[function(require,module,exports){
module.exports=function(e){return e({forMeter:{"default":"calculated_metrics",get:!0,put:!0,post:!0,query:!0,"delete":!0}})};


},{}],8:[function(require,module,exports){
module.exports=function(t){var e=t({"default":"/complaints",get:!0,query:!0,post:!0});return e};


},{}],9:[function(require,module,exports){
module.exports=function(t){return t({"default":"/accounts/me/consumption_stats",get:!0,forAccount:{"default":"consumption_stats",get:!0}})};


},{}],10:[function(require,module,exports){
module.exports=function(n,r){var t=n({"default":"/consumptions",forAccount:{"default":"consumptions",put:!0}});return t.get=function(n,t,u,o){return o=o||["energy"],o=angular.isArray(o)?o:[o],u=angular.isArray(u)?u:[u],r.request({method:"GET",url:[this._config["default"],n,t,u.join("+")].join("/"),params:{metrics:o.join(",")}})},t};


},{}],11:[function(require,module,exports){
module.exports=function(e){var t=e({"default":"/feeds",get:!0,query:!0,put:!0,post:!0,"delete":!0});return t};


},{}],12:[function(require,module,exports){
module.exports=function(t){return t({forAccount:{"default":"ftp_connections",get:!0,query:!0,put:!0,post:!0,"delete":!0}})};


},{}],13:[function(require,module,exports){
module.exports=function(t){return t({"default":"/accounts/me",get:!0,put:!0})};


},{}],14:[function(require,module,exports){
module.exports=function(e){return e({"default":"/stats/meters",get:!1,query:!0,put:!1,post:!1,"delete":!1})};


},{}],15:[function(require,module,exports){
var PATH_ASSIGN="/meters/many/assign_to",PATH_SHARE="/meters/many/share_with",PATH_REVOKE="/meters/many/revoke";module.exports=function(e,r){function t(e){return function(t,n){for(var a=[],u=t.length,o=n.length,s=0;u>s;s++)for(var h=t[s],m=0;o>m;m++){var A=n[m];a.push({_id:h,holder:A})}return r.request({url:e,method:"POST",data:a})}}function n(e){return r.request({url:PATH_REVOKE,method:"PUT",data:e})}var a=e({"default":"/meters",get:!0,query:!0,put:!0,post:!0,"delete":!0,batch:!0});return a.assign=t(PATH_ASSIGN),a.share=t(PATH_SHARE),a.revoke=n,a};


},{}],16:[function(require,module,exports){
module.exports=function(e){return e({"default":"/metric_models",get:!0,query:!0,put:!0,post:!0,"delete":!0})};


},{}],17:[function(require,module,exports){
module.exports=function(e){return e({"default":"/owners",get:!0,query:!0})};


},{}],18:[function(require,module,exports){
module.exports=function(t){return t({"default":"/accounts/me/password",put:!0})};


},{}],19:[function(require,module,exports){
module.exports=function(e){return e({"default":"/refreshtokens",query:!0})};


},{}],20:[function(require,module,exports){
module.exports=function(t){return t({"default":"/reports",post:!0})};


},{}],21:[function(require,module,exports){
module.exports=function(t){return t({"default":"/stats/robots",get:!1,query:!0,put:!1,post:!1,"delete":!1})};


},{}],22:[function(require,module,exports){
module.exports=function(t,e){var u=t({"default":"/robots",get:!0,query:!0,put:!0,post:!0,"delete":!0});return u.run=function(t){return e.request({url:[this._config["default"],t,"run"].join("/"),method:"POST"})},u};


},{}],23:[function(require,module,exports){
module.exports=function(e){return e({"default":"/scrapers",get:!0,query:!0})};


},{}],24:[function(require,module,exports){
module.exports=function(t){return t({forAccount:{"default":"subaccounts",get:"/accounts",put:!0,post:!0,query:!0,"delete":"/accounts"}})};


},{}],25:[function(require,module,exports){
var makeUrl=require("../util/makeurl");module.exports=function(e,r){function t(e,t){return r.request({method:"DELETE",url:makeUrl([this._config["default"],e]),data:{revoke_meters:t||!1},headers:{"Content-Type":"application/json;charset=UTF-8"}})}var o=e({forAccount:{"default":"meter_subscribers",get:!0,put:!0,post:!0,query:!0,"delete":!1}});return o._forAccount=o.forAccount,o.forAccount=function(e){var r=o._forAccount(e);return r["delete"]=t,r},o};


},{"../util/makeurl":27}],26:[function(require,module,exports){
var makeUrl=require("./util/makeurl"),ACCOUNTS_PATH="/accounts";module.exports=function(t){function r(t){function r(){this._config=t}return t.get&&(r.prototype.get=o),t.query&&(r.prototype.query=i),(t.put||t.post)&&(r.prototype.save=n),t.batch&&(r.prototype.batchUpdate=u),t["delete"]&&(r.prototype["delete"]=a),t.forAccount&&(r.prototype.forAccount=c("accounts",t.forAccount)),t.forMeter&&(r.prototype.forMeter=c("meters",t.forMeter)),new r}function e(t,r){var e=t[r];return e===!0?t["default"]:e}function o(r){return t.request({method:"GET",url:makeUrl([e(this._config,"get"),r])})}function n(r){var o,n,u=r;return void 0===r._id&&this._config.post?(o="POST",n=e(this._config,"post")):(o="PUT",n=e(this._config,"put")+"/"+r._id,u=angular.copy(r),delete u._id),t.request({method:o,url:n,data:u})}function u(r,o){for(var n=[],u=0,i=r.length;i>u;u++){var a=angular.copy(o);a._id=r[u],n.push(a)}return t.request({method:"PUT",url:e(this._config,"batch"),data:n})}function i(r){return t.request({method:"GET",url:e(this._config,"query"),params:f(r)})}function a(r){return t.request({method:"DELETE",url:makeUrl([e(this._config,"delete"),r])})}function c(t,e){return function(o){var n=angular.copy(e);return["default","get","put","post","delete","query"].forEach(function(r){var e=n[r];"string"==typeof e&&"/"!==e[0]&&(n[r]="/"+t+"/"+o+"/"+e)}),r(n)}}function f(t){var r={};for(var e in t)if(t.hasOwnProperty(e)){var o=t[e],n=angular.isString(o);null!=o&&(n&&o.length>0||!n)&&(r[e]=o)}return r}return r};


},{"./util/makeurl":27}],27:[function(require,module,exports){
module.exports=function(r,e){r=null==r?[]:angular.isArray(r)?r:[r];for(var n=[],o=0,a=r.length;a>o;o++){var l=r[o];if(null==l)break;n.push(l.replace(/^\/|\/$/,""))}var i=n.join("/")+"?";if("object"==typeof e)for(var t in e){var u=e[t];i+=t+"="+encodeURIComponent(u)+"&"}return i.slice(0,-1)};


},{}]},{},[4]);
